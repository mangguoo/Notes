# Package.json

> package.json记录当前项目中下载了哪些包，记录你下载的包信息（地址、版本号等），但是不包含这些模块依赖的其它子模块
>
> 当执行npm install的时候，node会先从package.json文件中读取所有dependencies信息，然后根据dependencies中的信息与node_modules中的模块进行对比，没有的直接下载，已有的检查更新

如果只有package.json文件记录包版本，在多人协作时，可能会造成每个人安装的依赖都不相同，因为package.json文件中不仅只能指定依赖的版本号，还可以通过版本符号限定一个大概的版本范围，简单来说就是package.json文件限定的版本不够具体

然后package-lock.json文件就出现了，它用以记录当前状态下安装的各个npm package的具体来源和版本号，模块下载地址、及这个模块又依赖了哪些依赖。在首次安装依赖包时会创建package-lock.json文件

当项目中已有package-lock.json文件，在安装项目依赖时，将以该文件为主进行解析安装指定版本依赖包，而不是使用package.json来解析和安装模块，package-lock 为每个模块及其每个依赖项指定了版本，位置和完整性哈希，按照这些信息进行安装，就可以保证每次装的依赖都是相同的

**package-lock.json文件的作用：**

1. 当删除node_module目录时，想通过npm install恢复所有包时，提升下载速度
2. 锁定版本号，防止自动升级新版本

package-lock.json文件锁定了依赖的版本号，所以当执行npm install的时候，node不会自动更新package.json文件中的模块，必须用npm install packagename（自动更新小版本号）或者npm install packagename@x.x.x（指定版本号）来进行安装才会更新，package-lock.json文件中的版本号也会随着更新

## npm install后发生了什么

![img](https://cdn.jsdelivr.net/gh/ilmangoi/imgRepo@main/img-2/cf8890adb8cc45759d1d7f37336e767a.png)

## 版本号含义

> 每个版本号都形如：1.2.1，有三部分组成，依次叫主版本号、次版本号、修订号

- 主版本号：当新版本无法兼容基于前一版本的代码时，则提高主版本号

- 次版本号：当新版本新增了功能和特性，但仍兼容前一版本的代码时，则提高次版本号

- 修订号：当新版本仅仅修正了漏洞或者增强了效率，仍然兼容前一版本代码，则提高修订号

## 版本符号

1. 波浪号：比如~1.2.2，表示安装1.2.x的最新版本（不低于1.2.2），但是不安装1.3.x，安装时不改变大版本号和次要版本号
2. 插入号：比如ˆ1.2.2，表示安装1.x.x的最新版本（不低于1.2.2），但是不安装2.x.x，安装时不改变大版本号
3. latest：安装最新版本

注意：如果大版本号为0，则插入号的行为与波浪号相同，因为0版本代表包此时处于开发阶段，即使是次要版本号变动，也可能带来程序的不兼容

所以建议使用~来标记版本号，这样可以保证项目不会出现大的问题，也能保证包中的小bug可以得到修复
